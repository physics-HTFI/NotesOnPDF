<Window
    x:Class="backend.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:backend"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    mc:Ignorable="d"
    Title="NotesOnPDF"
    Visibility="{Binding Visibility, Mode=TwoWay}"
    Height="280"
    Width="340"
    d:DataContext="{d:DesignInstance Type=local:MainWindowVM}"
    TextElement.Foreground="{DynamicResource MaterialDesignBody}"
    TextElement.FontWeight="Medium"
    TextElement.FontSize="14"
    FontFamily="{materialDesign:MaterialDesignFont}"
    ShowInTaskbar="False"
    Topmost="True"
    Background="Transparent"
    WindowStyle="None"
    AllowsTransparency="True">

    <Grid
        Margin="10">
        <Grid.Effect>
            <DropShadowEffect
                BlurRadius="10"
                ShadowDepth="3" />
        </Grid.Effect>
        <Rectangle
            Fill="AliceBlue"
            RadiusX="10"
            RadiusY="10" />
        <materialDesign:Flipper
            IsFlipped="{Binding IsSettingsOpen}"
            d:IsFlipped="False"
            Margin="15 5 15 10">
            <materialDesign:Flipper.FrontContent>
                <DockPanel>
                    <!-- ヘッダー -->
                    <DockPanel
                        DockPanel.Dock="Top">
                        <!-- アイコン -->
                        <Image
                            DockPanel.Dock="Left"
                            Width="15"
                            Height="15"
                            Source="../icon.ico" />
                        <!-- 終了 -->
                        <Button
                            DockPanel.Dock="Right"
                            Command="{Binding ExitCommand}"
                            ToolTip="アプリを完全に終了します"
                            ToolTipService.InitialShowDelay="0"
                            ToolTipService.Placement="Top"
                            Width="30"
                            Height="30"
                            Style="{StaticResource MaterialDesignIconButton}"
                            VerticalAlignment="Top">
                            <materialDesign:PackIcon
                                Width="30"
                                Height="30"
                                Kind="Close" />
                        </Button>
                        <!-- タイトル -->
                        <TextBlock
                            Style="{StaticResource MaterialDesignBody2TextBlock}"
                            Text="NotesOnPDF"
                            VerticalAlignment="Center"
                            Margin="8,0,0,0" />
                    </DockPanel>

                    <!-- メッセージ -->
                    <StackPanel
                        DockPanel.Dock="Bottom"
                        Orientation="Horizontal">
                        <TextBlock
                            Margin="5 0 0 0"
                            Style="{StaticResource MaterialDesignCaptionTextBlock}">
                            ※
                        </TextBlock>

                        <TextBlock
                            Style="{StaticResource MaterialDesignCaptionTextBlock}">
                            メイン画面を開いた後も終了せず、タスクバーの<LineBreak />
                            通知領域に常駐します
                        </TextBlock>
                    </StackPanel>

                    <!-- ボタン群 -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <!-- ブラウザで開く -->
                        <Button
                            Grid.Row="0"
                            Grid.Column="0"
                            Command="{Binding OpenInBrowserCommand}"
                            Margin="15 10"
                            Width="Auto"
                            Height="Auto">
                            <StackPanel>
                                <materialDesign:PackIcon
                                    Width="30"
                                    Height="30"
                                    Kind="OpenInNew"
                                    HorizontalAlignment="Center" />
                                <TextBlock
                                    Style="{StaticResource MaterialDesignCaptionTextBlock}"
                                    Text="ブラウザで開く"
                                    FontSize="13"
                                    HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <!-- ウィンドウで開く -->
                        <Button
                            Grid.Row="0"
                            Grid.Column="1"
                            Command="{Binding OpenWithWindowCommand}"
                            Margin="15 10"
                            Width="Auto"
                            Height="Auto">
                            <StackPanel>
                                <materialDesign:PackIcon
                                    Width="30"
                                    Height="30"
                                    Kind="OpenInApp"
                                    HorizontalAlignment="Center" />
                                <TextBlock
                                    Style="{StaticResource MaterialDesignCaptionTextBlock}"
                                    Text="ウィンドウで開く"
                                    FontSize="13"
                                    HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <!-- 入出力設定 -->
                        <Button
                            Name="Settings"
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="15 10"
                            Width="Auto"
                            Height="Auto"
                            Command="{Binding OpenSettingsCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}">
                            <StackPanel>
                                <materialDesign:PackIcon
                                    Width="30"
                                    Height="30"
                                    Kind="Settings"
                                    HorizontalAlignment="Center" />
                                <TextBlock
                                    Style="{StaticResource MaterialDesignCaptionTextBlock}"
                                    Text="入出力設定"
                                    FontSize="13"
                                    HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>

                        <!-- ウィンドウを隠す -->
                        <Button
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="15 10"
                            Width="Auto"
                            Height="Auto"
                            Command="{Binding ToggleWindowVisibilityCommand}"
                            ToolTip="このウィンドウを最小化してタスクトレイに常駐します"
                            ToolTipService.InitialShowDelay="0"
                            ToolTipService.Placement="Bottom"
                            Style="{StaticResource MaterialDesignOutlinedButton}">
                            <StackPanel>
                                <materialDesign:PackIcon
                                    Width="30"
                                    Height="30"
                                    Kind="Minimize"
                                    HorizontalAlignment="Center" />
                                <TextBlock
                                    Style="{StaticResource MaterialDesignCaptionTextBlock}"
                                    Text="最小化"
                                    FontSize="13"
                                    HorizontalAlignment="Center" />
                            </StackPanel>
                        </Button>
                    </Grid>
                </DockPanel>

            </materialDesign:Flipper.FrontContent>

            <!-- 設定パネル -->
            <materialDesign:Flipper.BackContent>
                <DockPanel
                    Margin="5 15 0 0">
                    <!-- OK, キャンセルボタン -->
                    <StackPanel
                        DockPanel.Dock="Bottom"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right">
                        <Button
                            DockPanel.Dock="Bottom"
                            Content="キャンセル"
                            Command="{Binding ResetSettingsCommand}"
                            Style="{StaticResource MaterialDesignFlatButton}">
                        </Button>

                        <Button
                            DockPanel.Dock="Bottom"
                            Content="OK"
                            Command="{Binding UpdateSettingsCommand}"
                            Style="{StaticResource MaterialDesignFlatButton}">
                        </Button>
                    </StackPanel>

                    <StackPanel>
                        <!-- ルートフォルダ -->
                        <DockPanel
                            Margin="0 0 0 5">
                            <Button
                                DockPanel.Dock="Right"
                                Width="35"
                                Height="35"
                                Command="{Binding SelectRootDirectoryCommand}"
                                Content="{materialDesign:PackIcon Folder}"
                                Style="{StaticResource MaterialDesignIconButton}" />
                            <TextBox
                                Height="40"
                                Margin="0,0,0,5"
                                Text="{Binding RootDirectory, UpdateSourceTrigger=PropertyChanged}"
                                materialDesign:HintAssist.Hint="PDF一覧の基準フォルダ"
                                ToolTip="アプリ画面左のPDFツリーの起点を指定します"
                                ToolTipService.InitialShowDelay="0"
                                ToolTipService.Placement="Left"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}" />
                        </DockPanel>

                        <!-- ダウンロードフォルダ -->
                        <DockPanel>
                            <Button
                                DockPanel.Dock="Right"
                                Width="35"
                                Height="35"
                                Command="{Binding SelectDownloadDirectoryCommand}"
                                Content="{materialDesign:PackIcon Folder}"
                                Style="{StaticResource MaterialDesignIconButton}" />
                            <TextBox
                                Height="40"
                                Margin="0,0,0,5"
                                Text="{Binding DownloadDirectory, UpdateSourceTrigger=PropertyChanged}"
                                materialDesign:HintAssist.Hint="ダウンロードフォルダ"
                                ToolTip="ダウンロードされたPDFファイルがここに保存されます"
                                ToolTipService.InitialShowDelay="0"
                                ToolTipService.Placement="Left"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}" />
                        </DockPanel>

                        <!-- ポート番号 -->
                        <ComboBox
                            Height="50"
                            Margin="0 0 35 0"
                            SelectedIndex="{Binding PortIndex}"
                            materialDesign:HintAssist.Hint="ポート番号"
                            materialDesign:HintAssist.IsFloating="True"
                            ToolTip="基本的に変える必要はありません。変更後はアプリを再起動してください。"
                            ToolTipService.InitialShowDelay="0"
                            ToolTipService.Placement="Left">
                            <ComboBoxItem
                                Content="8080" />
                            <ComboBoxItem
                                Content="8081" />
                            <ComboBoxItem
                                Content="8082" />
                            <ComboBoxItem
                                Content="8083" />
                            <ComboBoxItem
                                Content="8084" />
                            <ComboBoxItem
                                Content="8085" />
                        </ComboBox>
                    </StackPanel>
                </DockPanel>
            </materialDesign:Flipper.BackContent>
        </materialDesign:Flipper>
    </Grid>
</Window>
